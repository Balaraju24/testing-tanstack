import{i as g,j as t,r as p,B as y}from"./main-Cfdx-166.js";import{T as v}from"./TanstackTable-vIi7ShkO.js";import{g as S}from"./organization-BsG0MskM.js";import{D as W}from"./advocate-CZvQPyEV.js";import{a as z}from"./app-BaxlpBql.js";import{u as f}from"./useUserPermissions-EkOdBJwI.js";import{u as F}from"./useQuery-JrEwn0HC.js";import{u as D}from"./index-FfAIZCaX.js";import{S as V}from"./SearchFilter-CucxpMqz.js";import{E}from"./edit-note-icon-CA6xFLyb.js";import{g as A}from"./getColorByFirstLetter-JD099_BE.js";import{P as C}from"./plus-CqTDA3jy.js";import"./NoDataBlock-gmsqOTLj.js";import"./no-cases-data-1cuEGLat.js";import"./noDataConstants-nJx6rPaL.js";import"./select-CFrWO_XW.js";import"./index-C_gXUdb4.js";import"./index-CHQA3myx.js";import"./index-DE95MUWf.js";import"./index-hzHaN75t.js";import"./index-Vwln1SHO.js";import"./index-BoybbV93.js";import"./index-CUHrv82z.js";import"./index-BBlAPqfG.js";import"./chevron-down-CCzDJ7wY.js";import"./createLucideIcon-BmLFQ-XG.js";import"./check-eR3old9D.js";import"./skeleton-CvqsTR7_.js";import"./input-DYbhqlvz.js";import"./chevron-right-B9rEYsY4.js";import"./fetch-B9iWZIk4.js";import"./userDetails-BK07mqDr.js";import"./search-BG32cvb7.js";import"./x-OEbIHzu5.js";function L(){const c=g(),{isManager:l,isAdmin:x}=f(),r=[{accessorFn:e=>e.customer_id,id:"customer_id",cell:e=>t.jsx("span",{className:"text-xs",children:e.getValue()||"--"}),width:"130px",maxWidth:"130px",minWidth:"130px",header:()=>t.jsx("span",{className:"text-sm",children:"Institution ID"}),footer:e=>e.column.id},{accessorFn:e=>e.organisation_name,id:"organisation_name",cell:e=>t.jsx("div",{className:"text-xs w-32 truncate",title:e.getValue(),children:e.getValue()||"--"}),width:"140px",maxWidth:"140px",minWidth:"140px",header:()=>t.jsx("span",{className:"text-sm",children:"Organization"}),footer:e=>e.column.id},{accessorFn:e=>e.employee_id,id:"employee_id",cell:e=>t.jsx("span",{className:"text-xs",children:e.getValue()||"--"}),width:"130px",maxWidth:"130px",minWidth:"130px",header:()=>t.jsx("span",{className:"text-sm",children:"Employee ID"}),footer:e=>e.column.id},{accessorFn:e=>{const a=o=>o.replace(/\b\w/g,d=>d.toUpperCase()),s=e.first_name?a(e.first_name):"",m=e.last_name?a(e.last_name):"";return{fullname:`${s} ${m}`,avatar:e.profile_pic||null}},id:"first_name",cell:e=>{const{fullname:a,avatar:s}=e.getValue()||{fullname:"--",avatar:null};return t.jsx("span",{className:"flex gap-2 items-center",children:t.jsx("div",{className:"self-center text-xs truncate w-32",title:a,children:a})})},width:"120px",maxWidth:"120px",minWidth:"120px",header:()=>t.jsx("span",{className:"text-sm",children:"Employee"}),footer:e=>e.column.id},{accessorFn:e=>e.email,id:"email",cell:e=>t.jsx("div",{className:"truncate w-32 text-xs",title:e.getValue()||"",children:e.getValue()||"--"}),width:"180px",maxWidth:"180px",minWidth:"180px",header:()=>t.jsx("span",{className:"text-sm",children:"Email ID"}),footer:e=>e.column.id},{accessorFn:e=>e.phone?e.phone.replace(/^(\+91)(\d{5})(\d{5})$/,"$1 $2$3"):"--",id:"phone",cell:e=>t.jsx("span",{className:"text-xs",children:e.getValue()??"--"}),width:"140px",maxWidth:"140px",minWidth:"140px",header:()=>t.jsx("span",{className:"text-sm",children:"Phone Number"}),footer:e=>e.column.id},{accessorFn:e=>e.branch_code,id:"branch_code",cell:e=>t.jsx("span",{className:"text-xs flex gap-2 [&_svg]:size-4 items-center truncate w-32",title:e.getValue()||"--",children:e.getValue()||"--"}),width:"130px",maxWidth:"130px",minWidth:"130px",header:()=>t.jsx("span",{className:"text-sm",children:"Branch Code"}),footer:e=>e.column.id},{accessorFn:e=>e.branch_name,id:"branch_name",cell:e=>t.jsx("div",{className:"self-center text-xs truncate w-32",title:e.getValue()||"--",children:e.getValue()||"--"}),width:"140px",maxWidth:"140px",minWidth:"140px",header:()=>t.jsx("span",{className:"text-sm",children:"Branch Name"}),footer:e=>e.column.id},{accessorFn:e=>e.designation,id:"designation",cell:e=>t.jsx("span",{className:"text-xs flex gap-2 [&_svg]:size-4 items-center ",children:e.getValue()||"--"}),width:"120px",maxWidth:"120px",minWidth:"120px",header:()=>t.jsx("span",{className:"text-sm",children:"Designation"}),footer:e=>e.column.id}];return x()&&r.splice(6,0,{accessorFn:e=>e.location?.name,id:"location",cell:e=>{const a=e.getValue(),{background:s,color:m}=A(a||"");return t.jsx("div",{className:"text-xs flex gap-2 [&_svg]:size-4 cursor-pointer items-center px-2 py-1 rounded-full w-24 truncate whitespace-nowrap overflow-hidden",title:a,style:{backgroundColor:s,color:"#333333",border:`1px solid ${s}`},children:t.jsx("span",{className:"truncate w-32 ",children:a||"--"})})},width:"120px",maxWidth:"120px",minWidth:"120px",header:()=>t.jsx("span",{className:"text-sm",children:"Location"}),footer:e=>e.column.id}),l()&&r.splice(10,0,{accessorFn:e=>e.actions,id:"actions",cell:e=>t.jsx("div",{className:"table-action-buttons flex items-center  cursor-pointer",children:t.jsx("span",{onClick:()=>{c.navigate({to:`/edit-organization/${e.row.original.id}`})},title:"Edit Organization",children:t.jsx(E,{className:"size-4 text-black"})})}),header:()=>t.jsx("span",{className:"text-sm",children:"Actions"}),footer:e=>e.column.id,width:"80px",minWidth:"80px",maxWidth:"80px"}),r}const I=({heightClass:c=W})=>{const l=g(),x=D(),r=new URLSearchParams(x.search),[e,a]=p.useState(r.get("search_string")||""),[s,m]=p.useState(r.get("search_string")||""),[o,d]=p.useState({current_page:Number(r.get("page"))||1,page_size:Number(r.get("page_size"))||15}),{isAdmin:_}=f(),N=L(),{isLoading:j,data:h}=F({queryKey:["organization",o,s],queryFn:async()=>{let n={page:o.current_page,page_size:o.page_size,user_type:"CUSTOMER",...s&&{search_string:s}};const i=await S(n);if(i.status===200||i.status===201){const{records:w,pagination_info:u}=i?.data?.data;return{records:z(w,u.current_page,u.page_size)||[],pagination_info:u}}l.navigate({to:"/organizations",search:n})},enabled:!0,refetchOnWindowFocus:!1}),b=async({page:n,page_size:i})=>{d({current_page:n,page_size:i})};return p.useEffect(()=>{const n=setTimeout(()=>{d(i=>({...i,current_page:e?i.current_page:1})),m(e)},1e3);return()=>clearTimeout(n)},[e]),t.jsx("div",{className:"overflow-hidden h-full relative",children:t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex justify-end items-center gap-x-8 mb-2",children:t.jsxs("div",{className:"flex gap-x-3",children:[t.jsx(V,{searchString:e,setSearchString:a,title:"Search by Employee"}),!_()&&t.jsx(y,{className:"bg-black !text-white hover:bg-gray-800 cursor-pointer group focus:ring-none active:scale-95 !rounded-none h-9 px-6 py-0 transition duration-300 text-sm  3xl:text-base font-normal",onClick:()=>l.navigate({to:"/create-organization"}),children:t.jsxs("span",{className:"flex items-center space-x-2",children:[t.jsx(C,{className:"font-extralight w-6 h-6 group-hover:rotate-90 duration-300"}),t.jsx("span",{className:"font-extralight",children:"Add Organization"})]})})]})}),t.jsx("div",{className:"",children:t.jsx(v,{data:h?.records||[],columns:N,paginationDetails:h?.pagination_info||{},getData:b,loading:j,removeSortingForColumnIds:["serial","actions","first_name","gender","designation","email","phone","customer_id","organisation_name","employee_id","location","branch_name","branch_code"],heightClass:c,noDataLabel:"organizations",noDataDescription:s?"Try adjusting your search criteria":"Get started by creating your first organization",showNoDataIcon:!0,noDataHeight:c||"h-[calc(100vh-170px)]"})})]})})},fe=I;export{fe as component};
