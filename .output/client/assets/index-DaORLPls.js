import{j as e,h as Y,r as n,t as P,B as l}from"./main-CbopZ6M6.js";import{U as _}from"./Provider-BC_HjP_o.js";import{C as L}from"./calendar-B2nKypLE.js";import{P as U,a as A,b as B}from"./popover-CoI_Kke6.js";import{d as z}from"./legalOpinion-CVXYCweo.js";import{a as I}from"./statusConstants-CRfW9VUD.js";import{i as O,M as W}from"./ManageCaseHeader-5m-OMl3k.js";import{c as F}from"./manage-Dtja-RKh.js";import{u as H}from"./useUserPermissions-DqHuV15h.js";import{u as G}from"./useMutation-AZp6LET6.js";import{d}from"./dayjs.min-BPVt0UoP.js";import{P as R}from"./PendingStepOverlay-BsVQiSV2.js";import{C as T}from"./calendar-CPLYzr7c.js";import"./litigations-CmIaLu41.js";import"./fetch-BYBqU-UB.js";import"./manage-UYlebOZ2.js";import"./useQuery-aXFamHAp.js";import"./useInfiniteQuery-DCpiOsiQ.js";import"./index-Bz18Tu21.js";import"./index-DFgmobCw.js";import"./chevron-right-63yA6sUh.js";import"./createLucideIcon-2fvSvvVa.js";import"./chevron-down-DFI8aQgh.js";import"./index-CXHJR4o1.js";import"./index-NA-xklZo.js";import"./index-BfzcKS58.js";import"./index-BrJXLgSY.js";import"./index-C-zDLRzy.js";import"./index-BYuWQ9Ar.js";import"./index-9N-Gpv7K.js";import"./Loading-DliovM0z.js";import"./CaseFilingIcon-Ki22rwHg.js";import"./legal-notice-icon-DY79a5uN.js";import"./notes-edit-icon-Dx1vAmyL.js";import"./tooltip-BNtdrHqg.js";import"./index-CB5qnijn.js";import"./pending-icon-xk-CqbVY.js";import"./approved-Icon-sUM8RCgD.js";import"./current-icon-dhgqbcsv.js";import"./complete-logo-BdyjTQM1.js";import"./notes-close-icon-CZlPG_WL.js";import"./index-Bn1KO0DZ.js";import"./textarea-DVdyI6Fw.js";import"./loader-circle-CHBElFpm.js";import"./notification-B2GbDUfo.js";import"./service-Clbc7XwB.js";import"./fileUpload-CyZu8moV.js";import"./index-BFdYt5ff.js";import"./x-ClszbkRs.js";import"./default-user-B5Qt0uKr.js";import"./notes-delete-icon-COtxmY5M.js";import"./notes-head-icon-zA5gOWGa.js";import"./summary-icon-card-x7nT6ld4.js";import"./avatar-I9rQhuEx.js";import"./input-BFw7NH1J.js";import"./sheet-KGfwaNTI.js";import"./skeleton-CGIrBuj0.js";import"./userDetails-BKeSBteA.js";import"./utc-YeGeLL22.js";const V=o=>e.jsxs("svg",{width:320,height:310,viewBox:"0 0 900 600",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o,children:[e.jsx("path",{fill:"transparent",d:"M0 0h900v600H0z"}),e.jsx("path",{d:"M368.925 74.138v67.707m180.553-67.707v67.707m-282.112 92.304h383.673m11.283-13.313v191.837c0 67.707-33.853 112.845-112.845 112.845H368.925c-78.991 0-112.845-45.138-112.845-112.845V220.836c0-67.707 33.854-112.845 112.845-112.845h180.552c78.992 0 112.845 45.138 112.845 112.845z",stroke:"#E1E4E5",strokeWidth:24,strokeMiterlimit:10,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M542.587 338.2h.203m-.203 67.707h.203M459.1 338.2h.203m-.203 67.707h.203M375.569 338.2h.202m-.202 67.707h.202",stroke:"#E1E4E5",strokeWidth:48,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"m239.015 144.656-57.1 21.473C168.756 171.066 158 186.682 158 200.805v85.314c0 13.55 8.926 31.347 19.796 39.5L227 362.477c16.135 12.172 42.682 12.172 58.816 0l49.204-36.858c10.871-8.153 19.796-25.95 19.796-39.5v-85.314c0-14.123-10.756-29.739-23.915-34.676l-57.1-21.473c-9.726-3.559-25.288-3.559-34.786 0z",fill:"#aeaeae"}),e.jsx("path",{d:"M256.26 300.849c-27.781 0-50.301-22.521-50.301-50.301 0-27.781 22.52-50.301 50.301-50.301 27.78 0 50.301 22.52 50.301 50.301 0 27.78-22.521 50.301-50.301 50.301z",stroke:"#fff",strokeWidth:11,strokeMiterlimit:10,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M253.117 234.829v11.695c0 4.401 2.264 8.551 6.162 10.815l9.557 5.784",stroke:"#fff",strokeWidth:11,strokeMiterlimit:10,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M222.635 120.378c15.96 7.917 37.144-2.263 37.144-2.263s-4.708-23.011-20.677-30.917c-15.96-7.917-37.135 2.251-37.135 2.251s4.708 23.012 20.668 30.929z",fill:"url(#a)"}),e.jsx("circle",{r:11.515,transform:"matrix(1 0 0 -1 209.879 461.175)",fill:"#aeaeae"}),e.jsx("circle",{r:17.718,transform:"matrix(1 0 0 -1 668.35 91.494)",fill:"#aeaeae"}),e.jsx("circle",{cx:718.423,cy:237.046,r:11.51,fill:"#aeaeae"}),e.jsx("circle",{cx:726.197,cy:349.344,r:16.268,fill:"#E1E4E5"}),e.jsx("circle",{cx:695.878,cy:494.907,r:14.09,fill:"#E1E4E5"}),e.jsx("ellipse",{cx:197.861,cy:387.348,rx:8.543,ry:7.035,fill:"#E1E4E5"}),e.jsx("circle",{cx:246.606,cy:535.089,r:10.05,transform:"rotate(90 246.606 535.089)",fill:"#E1E4E5"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"a",x1:283.924,y1:145.073,x2:152.284,y2:40.946,gradientUnits:"userSpaceOnUse",children:[e.jsx("stop",{stopColor:"#fff"}),e.jsx("stop",{offset:1,stopColor:"#EEE"})]})})]}),Xe=({stage:o,subStage:c,mappedCaseStagesData:b})=>{const{service_id:v}=Y({strict:!1}),[r,u]=n.useState(void 0),[D,f]=n.useState(!1),[x,p]=n.useState(""),[h,m]=n.useState(!1),{isUser:g}=H(),{serviceData:a,setServiceData:M,caseStagesData:E}=_(),N=O(E?.sub_stages,c),{isPrevSubStageCompleted:k,subStageLabel:y}=F({stage:o,subStage:c,mappedCaseStagesData:b}),S=I[y],w={before:new Date},i=G({mutationFn:async({service_id:t,payload:s})=>await z(t,s),onSuccess:t=>{M(s=>({...s,due_date:d(r).format("DD MMM YYYY")})),P.success("Due date updated successfully"),p(""),m(!1)},onError:t=>{let s="Failed to update due date";t?.data?.errData?s=t?.data?.errData.due_date[0]:t?.response?.data?.message?s=t.response.data.message:t?.message&&(s=t.message),p(s)}}),C=t=>{u(t),f(!1)},j=()=>{const s={due_date:r?d(r).format("DD MMM YYYY"):"",stage:o,sub_stage:c};p(""),i.mutate({service_id:v,payload:s})};return n.useEffect(()=>{if(a?.due_date){const t=a.due_date;u(t)}a?.due_date===null&&m(!0)},[a?.due_date]),e.jsx("div",{className:"h-full",children:k?e.jsx("div",{className:"h-full px-1",children:e.jsxs("div",{className:"h-full relative",children:[e.jsx(W,{caseStage:o,caseSubStage:c,showActionButton:g()?!1:a?.due_date!==null&&!h,showUploadButton:!1,showNoteButton:!1}),g()?e.jsx("div",{className:"p-4",children:a?.due_date?e.jsx("div",{className:"flex bg-slate-100 justify-between items-center gap-2 border p-2",children:e.jsxs("p",{className:"text-sm",children:["Due Date :"," ",d(a?.due_date).format("DD MMM YYYY")]})}):e.jsxs("div",{className:" flex flex-col items-center justify-center text-center text-base",children:[e.jsx(V,{className:""}),e.jsx("span",{className:" text-gray-400 font-normal text-base",children:"Due date not assigned"})]})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"p-2 w-full h-[calc(100%-60px)] overflow-auto",children:e.jsx("div",{className:"bg-white relative p-2",children:h?e.jsxs("div",{className:"flex flex-col gap-4 max-w-xs",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"relative",children:e.jsxs(U,{open:D,onOpenChange:f,children:[e.jsx(A,{asChild:!0,children:e.jsxs(l,{variant:"outline",id:"due-date",className:"w-full justify-start  border border-gray-300 text-left font-normal !rounded-none  cursor-pointer pr-10",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),r?d(r).format("DD MMM YYYY"):e.jsx("span",{className:"text-muted-foreground",children:"Select a date"})]})}),e.jsx(B,{className:"w-auto p-0 bg-white",align:"start",children:e.jsx(L,{mode:"single",selected:r,onSelect:C,captionLayout:"dropdown",disabled:w,fromYear:2025,toYear:2030,className:"[&>div>button.bg-accent]:!bg-transparent [&>div>button.bg-accent]:!text-current",modifiers:{today:new Date},modifiersClassNames:{today:"text-blue-900 "}})})]})}),x&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:x})]}),a?.due_date===null?e.jsx(l,{onClick:j,disabled:i.isPending,className:" w-full bg-black hover:bg-black  text-white cursor-pointer font-medium active:scale-95 duration-300 transition-all text-sm 3xl:text-base px-4 py-0 h-8 rounded-none focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:ring-transparent focus:ring-none  outline-none focus:outline-none",children:i.isPending?"Adding...":"Add"}):e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{onClick:()=>m(!1),disabled:i.isPending,className:" flex-1 bg-transparent cursor-pointer border rounded-none active:scale-95 duration-300 transition-all  text-black font-medium text-sm 3xl:text-base px-4 py-0 h-8 outline-none focus:outline-none hover:bg-transparent",children:"Close"}),e.jsx(l,{onClick:j,disabled:i.isPending,className:"flex-1 bg-black hover:bg-black  text-white cursor-pointer font-medium active:scale-95 duration-300 transition-all text-sm 3xl:text-base px-4 py-0 h-8 rounded-none focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:ring-transparent focus:ring-none  outline-none focus:outline-none",children:i.isPending?"Updating...":"Update"})]})]}):e.jsxs("div",{className:"flex bg-slate-100 justify-between items-center gap-2 border border-gray-300 p-2",children:[e.jsxs("p",{className:"text-sm",children:["Due Date :"," ",d(a?.due_date).format("DD MMM YYYY")]}),!N&&e.jsx(l,{className:"bg-transparent h-fit py-0 font-semibold underline text-xs !shadow-none cursor-pointer",onClick:()=>m(!0),children:"Edit"})]})})})})]})}):e.jsx(R,{title:S})})};export{Xe as default};
