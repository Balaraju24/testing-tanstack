import{r,h as q,k as V,j as G}from"./main-Cfdx-166.js";import{e as O}from"./litigations-CHZYp0Qz.js";import{f as Q,c as M}from"./manage-N6m0a4Rv.js";import{u}from"./useQuery-JrEwn0HC.js";import{u as K}from"./useInfiniteQuery-CsBoIoE-.js";import{u as j}from"./index-FfAIZCaX.js";const g=r.createContext({caseStagesData:null,caseStagesIsLoading:!1,isError:!1,isFetchingNextPage:!1,getCaseStagesRefetch:async()=>Promise.resolve({}),fetchNextPage:()=>Promise.resolve({}),serviceData:null,setServiceData:()=>{},allDocsData:null,allDocsIsFetching:!1,allDocsIsLoading:!1,getAllDocsRefetch:async()=>Promise.resolve({}),hasNextPage:!1,isLoadingCaseNote:!1,refetchCaseNotes:()=>Promise.resolve({}),allRecords:[],notes:null,setNotes:()=>{},notesId:null,setNotesId:()=>{}}),X=()=>r.useContext(g),Y=({children:f})=>{const{service_id:o}=q({strict:!1}),l=j(),d=V({strict:!1}),n=l.pathname,c=d.stage,s=d.sub_stage,[p,m]=r.useState(null),[h,C]=r.useState(null),[I,P]=r.useState(null),{isLoading:F,data:_,isError:R,refetch:S}=u({queryKey:["caseStages",o],queryFn:async()=>{const e=await O({case_id:o});if(e.status===200||e.status===201)return e?.data?.data;throw new Error("Failed to fetch case stages")},enabled:!!o,refetchOnWindowFocus:!1}),{isLoading:D,isFetching:N,data:v,refetch:y}=u({queryKey:["file-details",o,c,s,l.pathname],queryFn:async({signal:t})=>{try{if(!o||n.includes("case-history")||n.includes("notes")||n.includes("logs")||n.includes("chat")||n.includes("files")||n.includes("advocate-approval")||s==="PRBD")return{signal:t};let e={};s==="CSFG#DREV"?e={case_stage:"CSFG",case_sub_stages:["CSFG#DAPT","CSFG#DROC","CSFG#DROP","CSFG#DRCR","CSFG#DRAP"].map(encodeURIComponent),verification_status:"APPROVED"}:s==="VEFI#FICV"||s==="FIUP#UPAF"?e={case_stages:["FIUP","VEFI"].map(encodeURIComponent),case_sub_stages:["FIUP#UPAF","VEFI#FICV"].map(encodeURIComponent)}:s==="QURI#MDSC"?e={case_stages:["QURI"].map(encodeURIComponent),case_sub_stages:["QURI#RQMD","QURI#MDSC"].map(encodeURIComponent)}:s==="SLNT#SNNT"?e={case_stages:["DLNT","SLNT"].map(encodeURIComponent),case_sub_stages:["DLNT#DFNT","SLNT#SNNT"].map(encodeURIComponent)}:e={case_stage:c,case_sub_stage:s&&encodeURIComponent(s)};const a=await Q(o,e,{signal:t});if(a.status===200||a.status===201)return a.data?.data?.records;throw new Error("Failed to fetch documents")}catch(e){if(e.name==="AbortError")return;throw new Error("Failed to fetch case data")}},enabled:!!o,refetchOnWindowFocus:!1}),U=async({pageParam:t=1})=>{try{if(!o)return;let e={};e={case_stage:c,case_sub_stage:s&&encodeURIComponent(s),types:["NOTE","CASE_DRAFT_REMARKS"],page:t};const a=await M(o,e),i=a?.data?.data?.records||[];return{data:i,nextCursor:i.length>0&&a?.data?.data?.pagination_info?.next_page?a?.data?.data?.pagination_info?.current_page+1:void 0,prevCursor:a?.data?.data?.pagination_info?.current_page!==1?a?.data?.data?.pagination_info?.current_page-1:void 0,totalRecords:a?.data?.data?.pagination_info?.total_records}}catch{throw new Error("Failed to fetch case notes")}},{data:x,fetchNextPage:E,hasNextPage:A,isFetching:w,isFetchingNextPage:L,refetch:b}=K({initialPageParam:1,queryKey:["case-notes",o,c,s],queryFn:U,getNextPageParam:t=>{if(!t)return;const{nextCursor:e,data:a}=t;return a.length>0&&e?e:void 0},getPreviousPageParam:t=>t?.prevCursor??void 0,refetchOnWindowFocus:!1,enabled:!!o}),T=x?.pages.map(t=>t.data).flat()||[];return G.jsx(g.Provider,{value:{caseStagesData:_,caseStagesIsLoading:F,isError:R,getCaseStagesRefetch:S,allDocsData:v,allDocsIsFetching:N,allDocsIsLoading:D,getAllDocsRefetch:y,fetchNextPage:E,hasNextPage:A,isLoadingCaseNote:w,isFetchingNextPage:L,refetchCaseNotes:b,allRecords:T,notes:p,setNotes:m,notesId:h,setNotesId:C,serviceData:I,setServiceData:P},children:f})};export{Y as C,X as U};
