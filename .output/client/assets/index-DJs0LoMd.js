import{j as e,r as p,u as M,h as H,t as l}from"./main-CbopZ6M6.js";import{L as B}from"./Loading-DliovM0z.js";import{L as R}from"./location-icon-CIQbOvBm.js";import{d as K}from"./advocate-DDA6A40v.js";import{a as q,u as Q}from"./organization-DUPrsTbb.js";import{s as N}from"./stateConstants-CjBDojTL.js";import{d as W}from"./deletePayload-CDQM6veK.js";import{u as X}from"./useQuery-aXFamHAp.js";import{u as P}from"./useMutation-AZp6LET6.js";import{c as G}from"./createLucideIcon-2fvSvvVa.js";import{X as J}from"./x-ClszbkRs.js";import{S as T}from"./search-ElaKESin.js";import{C as Y}from"./chevron-down-DFI8aQgh.js";import{C as ee}from"./check-CKzaR09m.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],te=G("phone",ae);function se({className:v}){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M18.75 16.2498H17.5V7.49984C17.5 7.16832 17.3683 6.85037 17.1339 6.61595C16.8995 6.38153 16.5815 6.24984 16.25 6.24984H11.25V2.49984C11.2501 2.27348 11.1888 2.05133 11.0726 1.8571C10.9563 1.66287 10.7895 1.50385 10.59 1.39702C10.3904 1.29018 10.1656 1.23953 9.93951 1.25049C9.71342 1.26144 9.49454 1.33358 9.30625 1.45921L3.05625 5.62484C2.8848 5.73923 2.74429 5.89424 2.64724 6.07607C2.55019 6.2579 2.49961 6.46091 2.5 6.66702V16.2498H1.25C1.08424 16.2498 0.925268 16.3157 0.808058 16.4329C0.690848 16.5501 0.625 16.7091 0.625 16.8748C0.625 17.0406 0.690848 17.1996 0.808058 17.3168C0.925268 17.434 1.08424 17.4998 1.25 17.4998H18.75C18.9158 17.4998 19.0747 17.434 19.1919 17.3168C19.3092 17.1996 19.375 17.0406 19.375 16.8748C19.375 16.7091 19.3092 16.5501 19.1919 16.4329C19.0747 16.3157 18.9158 16.2498 18.75 16.2498ZM16.25 7.49984V16.2498H11.25V7.49984H16.25ZM3.75 6.66702L10 2.49984V16.2498H3.75V6.66702ZM8.75 8.74984V9.99984C8.75 10.1656 8.68415 10.3246 8.56694 10.4418C8.44973 10.559 8.29076 10.6248 8.125 10.6248C7.95924 10.6248 7.80027 10.559 7.68306 10.4418C7.56585 10.3246 7.5 10.1656 7.5 9.99984V8.74984C7.5 8.58408 7.56585 8.4251 7.68306 8.30789C7.80027 8.19068 7.95924 8.12484 8.125 8.12484C8.29076 8.12484 8.44973 8.19068 8.56694 8.30789C8.68415 8.4251 8.75 8.58408 8.75 8.74984ZM6.25 8.74984V9.99984C6.25 10.1656 6.18415 10.3246 6.06694 10.4418C5.94973 10.559 5.79076 10.6248 5.625 10.6248C5.45924 10.6248 5.30027 10.559 5.18306 10.4418C5.06585 10.3246 5 10.1656 5 9.99984V8.74984C5 8.58408 5.06585 8.4251 5.18306 8.30789C5.30027 8.19068 5.45924 8.12484 5.625 8.12484C5.79076 8.12484 5.94973 8.19068 6.06694 8.30789C6.18415 8.4251 6.25 8.58408 6.25 8.74984ZM6.25 13.1248V14.3748C6.25 14.5406 6.18415 14.6996 6.06694 14.8168C5.94973 14.934 5.79076 14.9998 5.625 14.9998C5.45924 14.9998 5.30027 14.934 5.18306 14.8168C5.06585 14.6996 5 14.5406 5 14.3748V13.1248C5 12.9591 5.06585 12.8001 5.18306 12.6829C5.30027 12.5657 5.45924 12.4998 5.625 12.4998C5.79076 12.4998 5.94973 12.5657 6.06694 12.6829C6.18415 12.8001 6.25 12.9591 6.25 13.1248ZM8.75 13.1248V14.3748C8.75 14.5406 8.68415 14.6996 8.56694 14.8168C8.44973 14.934 8.29076 14.9998 8.125 14.9998C7.95924 14.9998 7.80027 14.934 7.68306 14.8168C7.56585 14.6996 7.5 14.5406 7.5 14.3748V13.1248C7.5 12.9591 7.56585 12.8001 7.68306 12.6829C7.80027 12.5657 7.95924 12.4998 8.125 12.4998C8.29076 12.4998 8.44973 12.5657 8.56694 12.6829C8.68415 12.8001 8.75 12.9591 8.75 13.1248Z",fill:"black"})})}const je=()=>{const v=p.useRef(null),_=M(),{organization_id:m}=H({strict:!1}),[s,x]=p.useState({}),[f,b]=p.useState(!1),[y,j]=p.useState(""),[V,Z]=p.useState({state:"bottom"}),[r,h]=p.useState({organisation_name:"",branch_name:"",branch_code:"",first_name:"",last_name:"",employee_id:"",phone:"",email:"",is_active:!0,is_verified:!1,designation:"",state:""}),w={organisation_name:"",branch_name:"",branch_code:"",first_name:"",last_name:"",employee_id:"",phone:"",email:"",is_active:!0,is_verified:!1,designation:"",state:""},o="w-full p-3 bg-gray-100 outline-none text-xs rounded-none border-none",c="block text-xs font-medium text-gray-700 mb-1",d="text-red-500 text-xs mt-0.5",z=N.filter(a=>a.name.toLowerCase().includes(y.toLowerCase())),E=a=>{const t=N.find(i=>i.code===a.state)?.name||a.state;return W({...a,state:t,phone:a.phone?`+91${a.phone}`:a.phone},["designation","branch_name","branch_code"])},{data:n,isLoading:S}=X({queryKey:["organization",m],queryFn:async()=>{const a=await K(m);if(a?.status===200||a?.status===201)return a.data.data},refetchOnWindowFocus:!1,enabled:!!m}),{mutate:F,isPending:A}=P({mutationKey:["add-organization"],mutationFn:async a=>{const t=E(a);return(await q(t))?.data},onSuccess:()=>{x({}),l.success("Organization Added Successfully",{action:{label:"✕",onClick:()=>l.dismiss()}}),h(w),j(""),_({to:"/organizations"})},onError:a=>{if(a){const t=a?.data?.errData||{};x(t),l.error("Failed to Add the Organization",{action:{label:"✕",onClick:()=>l.dismiss()}})}else l.error("Failed to Add the Organization",{action:{label:"✕",onClick:()=>l.dismiss()}})}}),{mutate:U,isPending:k}=P({mutationKey:["update-organization",m],mutationFn:async a=>{const t=E(a);return(await Q(m,t))?.data},onSuccess:()=>{x({}),l.success("Organization Updated Successfully",{action:{label:"✕",onClick:()=>l.dismiss()}}),h(w),j(""),_({to:"/organizations"})},onError:a=>{if(a){const t=a?.data?.errData||{};x(t),l.error("Failed to Update the Organization",{action:{label:"✕",onClick:()=>l.dismiss()}})}else l.error("Failed to Update the Organization",{action:{label:"✕",onClick:()=>l.dismiss()}})}}),g=a=>{const{name:t,value:i}=a.target;h(u=>({...u,[t]:i})),s[t]&&x(u=>({...u,[t]:void 0}))},$=a=>{h(t=>({...t,state:a.code})),j(a.name),b(!1),s.state&&x(t=>({...t,state:void 0}))},D=a=>{a.stopPropagation(),h(t=>({...t,state:""})),j("")},O=a=>{a.preventDefault(),m?U(r):F(r)},L=a=>{const{name:t,value:i}=a.target,u=i.replace(/[^A-Za-z\s-]/g,"");h(C=>({...C,[t]:u})),s[t]&&x(C=>({...C,[t]:void 0}))};return p.useEffect(()=>{const a=()=>{if(v.current){const i=v.current.getBoundingClientRect(),u=window.innerHeight-i.bottom,C=i.top;Z(I=>({...I,state:u<200&&C>200?"top":"bottom"}))}},t=i=>{v.current&&!v.current.contains(i.target)&&b(!1)};return f&&(a(),window.addEventListener("scroll",a),window.addEventListener("resize",a)),document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t),window.removeEventListener("scroll",a),window.removeEventListener("resize",a)}},[f]),p.useEffect(()=>{n&&(h({organisation_name:n.organisation_name||"",branch_name:n.branch_name||"",branch_code:n.branch_code||"",first_name:n.first_name||"",last_name:n.last_name||"",employee_id:n.employee_id||"",phone:n.phone?n.phone.replace("+91",""):"",email:n.email||"",is_active:n.is_active??!0,is_verified:n.is_verified??!1,designation:n.designation||"",state:n.state||""}),j(N.find(a=>a.code===n.state)?.name||n.state||""))},[n]),e.jsx("div",{className:"w-full overflow-hidden h-[calc(100%-2px)]",children:S?e.jsx(B,{loading:S}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white p-2 2xl:p-4",children:[e.jsxs("form",{onSubmit:O,className:"mb-2 rounded-none border border-gray-200 p-2 2xl:p-3 overflow-y-auto h-[calc(100vh-124px)] 2xl:h-[calc(100vh-160px)]",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3 text-sm font-semibold text-gray-800",children:[e.jsx(se,{className:"h-5 w-5"}),e.jsx("div",{className:"ml-2",children:"Organization Details"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["Organization Name"," ",e.jsx("span",{className:"text-sm text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"organisation_name",value:r.organisation_name,placeholder:"Enter organization name",className:o,onChange:a=>{let t=a.target.value;t=t.charAt(0).toUpperCase()+t.slice(1),/^[A-Za-z_ ]*$/.test(t)&&g({target:{name:a.target.name,value:t}})}}),s.organisation_name&&s.organisation_name.length>0&&e.jsx("div",{className:d,children:s.organisation_name.map((a,t)=>e.jsx("p",{children:a},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["First Name"," ",e.jsx("span",{className:"text-sm text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"first_name",value:r.first_name,onChange:a=>{let t=a.target.value;t=t.charAt(0).toUpperCase()+t.slice(1),/^[A-Za-z_ ]*$/.test(t)&&L({target:{name:a.target.name,value:t}})},placeholder:"Enter first name",className:o}),s.first_name&&s.first_name.length>0&&e.jsx("div",{className:d,children:s.first_name.map((a,t)=>e.jsx("p",{children:a},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["Last Name"," ",e.jsx("span",{className:"text-sm text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"last_name",value:r.last_name,onChange:a=>{let t=a.target.value;t=t.charAt(0).toUpperCase()+t.slice(1),/^[A-Za-z_ ]*$/.test(t)&&L({target:{name:a.target.name,value:t}})},placeholder:"Enter last name",className:o}),s.last_name&&s.last_name.length>0&&e.jsx("div",{className:d,children:s.last_name.map((a,t)=>e.jsx("p",{children:a},t))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["Employee ID ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"employee_id",value:r.employee_id,onChange:a=>{let t=a.target.value;t=t.toUpperCase(),/^[A-Za-z0-9 -]*$/.test(t)&&g({target:{name:a.target.name,value:t}})},placeholder:"Enter employee id",className:o}),s.employee_id&&s.employee_id.length>0&&e.jsx("div",{className:d,children:s.employee_id.map((a,t)=>e.jsx("p",{children:a},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Branch Name"}),e.jsx("input",{type:"text",name:"branch_name",value:r.branch_name,onChange:a=>{let t=a.target.value;t=t.charAt(0).toUpperCase()+t.slice(1),/^[A-Za-z_ ]*$/.test(t)&&g({target:{name:a.target.name,value:t}})},placeholder:"Enter branch name",className:o}),s.branch_name&&s.branch_name.length>0&&e.jsx("div",{className:d,children:s.branch_name.map((a,t)=>e.jsx("p",{children:a},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["Branch Code ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"branch_code",value:r.branch_code,onChange:a=>{let t=a.target.value;t=t.toUpperCase(),/^[A-Z0-9 -/]*$/.test(t)&&g({target:{name:a.target.name,value:t}})},placeholder:"Enter branch code",className:o}),s.branch_code&&s.branch_code.length>0&&e.jsx("div",{className:d,children:s.branch_code.map((a,t)=>e.jsx("p",{children:a},t))})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-5",children:e.jsxs("div",{children:[e.jsx("label",{className:c,children:"Designation"}),e.jsx("input",{type:"text",name:"designation",value:r.designation,onChange:a=>{let t=a.target.value;t=t.charAt(0).toUpperCase()+t.slice(1),/^[A-Za-z_ ]*$/.test(t)&&g({target:{name:a.target.name,value:t}})},placeholder:"Enter designation",className:o}),s.designation&&s.designation.length>0&&e.jsx("div",{className:d,children:s.designation.map((a,t)=>e.jsx("p",{children:a},t))})]})})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"flex items-center mb-3 text-sm font-semibold text-gray-800",children:[e.jsx(te,{className:"w-4 h-4 mr-1"}),e.jsx("div",{children:"Verification Details"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["Phone Number"," ",e.jsx("span",{className:"text-sm text-red-600",children:"*"})]}),e.jsx("input",{name:"phone",value:r.phone,onChange:a=>{const t=a.target.value;/^\d{0,10}$/.test(t)&&g(a)},placeholder:"Enter number",className:o,pattern:"[0-9]*"}),s.phone&&s.phone.length>0&&e.jsx("div",{className:d,children:s.phone.map((a,t)=>e.jsx("p",{children:a},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:c,children:["Email Id"," ",e.jsx("span",{className:"text-sm text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:g,placeholder:"Enter email",className:o}),s.email&&s.email.length>0&&e.jsx("div",{className:d,children:s.email.map((a,t)=>e.jsx("p",{children:a},t))})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center mb-3 text-sm font-semibold text-gray-800",children:[e.jsx(R,{className:"w-5 h-5 mr-1"}),e.jsx("div",{children:"Address"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-2",children:e.jsxs("div",{className:"relative",ref:v,children:[e.jsxs("label",{className:c,children:["State ",e.jsx("span",{className:"text-sm text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search or select state...",value:y,onChange:a=>{j(a.target.value),b(!0);const t=N.find(i=>i.code===r.state);t&&a.target.value!==t.name&&h(i=>({...i,state:""}))},onFocus:()=>b(!0),className:`${o} pr-20`}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center",children:[r.state&&e.jsx("button",{type:"button",onClick:D,className:"p-1 hover:bg-gray-200 rounded mr-1",children:e.jsx(J,{className:"h-4 w-4 text-gray-400 hover:text-gray-600 cursor-pointer"})}),e.jsx("div",{className:"flex items-center pr-3 pointer-events-none",children:e.jsx(T,{className:"h-4 w-4 text-gray-400"})}),e.jsx("button",{type:"button",onClick:()=>b(!f),className:"flex items-center pr-2",children:e.jsx(Y,{className:`h-4 w-4 text-gray-400 transition-transform ${f?"rotate-180":""}`})})]})]}),f&&e.jsx("div",{className:`absolute z-50 w-full bg-white border border-gray-200 shadow-lg rounded-sm max-h-48 overflow-y-auto left-0 ${V.state==="top"?"bottom-full mb-1":"top-full mt-1"}`,children:z.length>0?z.map(a=>e.jsxs("div",{onClick:()=>$(a),className:`flex items-center justify-between px-3 py-2 hover:bg-gray-50 cursor-pointer text-xs ${r.state===a.code?"bg-gray-50":""}`,children:[e.jsx("span",{className:"flex-1",children:a.name}),r.state===a.code&&e.jsx(ee,{className:"h-4 w-4 text-green-600"})]},a.code)):e.jsx("div",{className:"px-3 py-2 text-xs text-gray-400",children:"No states found"})}),s.state&&s.state.length>0&&e.jsx("div",{className:d,children:s.state.map((a,t)=>e.jsx("p",{children:a},t))})]})})]})]}),e.jsxs("div",{className:"flex gap-4 justify-end",children:[m&&e.jsx("button",{className:"bg-white text-black px-4 py-2 rounded-none text-sm font-normal border transition cursor-pointer",onClick:()=>_({to:"/organizations"}),children:"Cancel"}),e.jsx("button",{onClick:O,className:"bg-black text-white px-4 py-2 rounded-none text-sm font-normal hover:bg-gray-800 transition cursor-pointer",disabled:A||k,children:A||k?"Saving...":m?"Update":"Create"})]})]})})})};export{je as C};
