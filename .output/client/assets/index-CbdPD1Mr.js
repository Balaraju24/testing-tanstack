import{h as E,r as m,j as e,B as d}from"./main-Cfdx-166.js";import{U as M}from"./Provider-ByMBYsBJ.js";import{I as _}from"./input-DYbhqlvz.js";import{A as k}from"./manage-N6m0a4Rv.js";import{a as A}from"./statusConstants-CRfW9VUD.js";import{i as D,M as I}from"./ManageCaseHeader-C-iqY6N9.js";import{c as B}from"./manage-B5DlZb4f.js";import{u as L}from"./useMutation-B1DU5d2J.js";import{G as U}from"./GetCaseNotes-DTiXzwk0.js";import{P as G}from"./PendingStepOverlay-Dz6uvJCx.js";import{L as K}from"./loader-circle-CtVpcMqj.js";import"./litigations-CHZYp0Qz.js";import"./fetch-B9iWZIk4.js";import"./useQuery-JrEwn0HC.js";import"./useInfiniteQuery-CsBoIoE-.js";import"./index-FfAIZCaX.js";import"./index-CHQA3myx.js";import"./index-lXLfk88N.js";import"./Loading-CBYA94ZU.js";import"./CaseFilingIcon-B3T83UWb.js";import"./legal-notice-icon-CQRroJUz.js";import"./notes-edit-icon-DR2vjJ_2.js";import"./index-C_gXUdb4.js";import"./index-hzHaN75t.js";import"./index-DF_xtgj4.js";import"./tooltip-Dk48ikt-.js";import"./index-DE95MUWf.js";import"./index-BoybbV93.js";import"./index-BBlAPqfG.js";import"./useUserPermissions-EkOdBJwI.js";import"./userDetails-BK07mqDr.js";import"./pending-icon-DAWTPq6S.js";import"./approved-Icon-DeOvi-fV.js";import"./current-icon-8I7qxN0n.js";import"./chevron-down-CCzDJ7wY.js";import"./createLucideIcon-BmLFQ-XG.js";import"./complete-logo-C9qAcUgu.js";import"./notes-close-icon-DwQRAOm_.js";import"./index-DETgyAaU.js";import"./index-Vwln1SHO.js";import"./textarea-HR3ErcZs.js";import"./notification-Dr26wPLe.js";import"./service-7i-FAUkJ.js";import"./fileUpload-C5Dy2rVy.js";import"./index-BjReNNxi.js";import"./x-OEbIHzu5.js";import"./default-user-H6DJgCjJ.js";import"./notes-delete-icon-BGPvWUIE.js";import"./notes-head-icon-B7j4bc-E.js";import"./summary-icon-card-D2HQg2x6.js";import"./avatar-BO1wJRFV.js";import"./sheet-CMzcKqsy.js";import"./skeleton-CvqsTR7_.js";import"./dayjs.min-CmsQqqGy.js";import"./utc-BVtgXMZy.js";const Fe=({stage:f,subStage:n,mappedCaseStagesData:h})=>{const{service_id:g}=E({strict:!1}),[x,o]=m.useState(""),[p,l]=m.useState(!1),[a,c]=m.useState(""),{caseStagesData:N,serviceData:s,setServiceData:C}=M(),u=D(N?.sub_stages,n),{isPrevSubStageCompleted:j,subStageLabel:v}=B({stage:f,subStage:n,mappedCaseStagesData:h}),S=A[v],{mutate:y,isPending:i}=L({mutationFn:async t=>await k(g,t),onSuccess:()=>{C(t=>({...t,cmp_number:a})),l(!1)},onError:t=>{if(t?.status===404||t?.status===401)o(t.message);else if(t.status==422){let r=t.data.errData;o(r?.cmp_number[0])}else if(t.status==409){let r=t.message;o(r)}}}),b=()=>{if(!a?.trim()){o("CMP Number is required");return}y({cmp_number:a})},P=()=>{c(s?.cmp_number??""),l(!1),o("")},w=t=>{t.key==="Enter"&&a.length>0&&b()};return m.useEffect(()=>{s&&typeof s.cmp_number=="string"&&c(s.cmp_number)},[s]),e.jsx("div",{className:"h-full",children:j?e.jsx("div",{className:"h-full px-1",children:e.jsxs("div",{className:"h-full",children:[e.jsx(I,{showActionButton:!p&&!!s?.cmp_number,caseStage:f,caseSubStage:n,showUploadButton:!1}),e.jsxs("div",{className:"p-2 relative w-full  h-[calc(100%-60px)] overflow-auto",children:[e.jsx("div",{className:"py-4 px-2 flex  gap-4 w-full",children:e.jsxs("div",{className:"w-full space-y-1",children:[e.jsxs("span",{children:["CMP Number"," ",e.jsx("span",{className:"text-sm text-red-600 -mt-0",children:"*"})]}),!p&&s?.cmp_number?e.jsxs("div",{className:"flex bg-slate-100 justify-between items-center text-sm gap-2 border-none p-2",children:[e.jsx("p",{children:s?.cmp_number}),!u&&e.jsx(d,{className:"bg-transparent h-fit py-0 font-semibold underline text-xs cursor-pointer",onClick:()=>l(!0),children:"Edit"})]}):e.jsxs("div",{className:"space-y-2 w-full mt-1",children:[e.jsx(_,{placeholder:"Enter CMP Number",value:a,onChange:t=>{const r=t.target.value.toUpperCase().trim();/^[A-Z0-9]*$/.test(r)&&(c(r),o(""))},onKeyDown:w,maxLength:16,disabled:i||u,className:"w-full rounded-none border h-fit border-gray-200 focus:outline-none focus-visible:outline-none bg-gray-100 text-black"}),x&&e.jsx("span",{className:"text-red-500 text-xs block mt-1",children:x}),e.jsxs("div",{className:"flex justify-end gap-2",children:[p&&e.jsx(d,{onClick:P,disabled:i,variant:"outline",className:"rounded-none text-red-500 text-xs h-8 py-1.5 font-normal cursor-pointer",children:"Cancel"}),e.jsx(d,{onClick:b,disabled:i||u,className:"rounded-none text-white text-xs bg-black h-8 py-1.5 font-normal hover:bg-black cursor-pointer",children:i?e.jsx(K,{className:"animate-spin"}):"Submit"})]})]})]})}),e.jsx(U,{})]})]})}):e.jsx(G,{title:S})})};export{Fe as default};
