import{i as E,u as L,j as t,r as o,a as q,B as S}from"./main-CbopZ6M6.js";import{T as K,P as B}from"./TanstackTable-OjcbGlVt.js";import{A as Q,S as J,g as X,T as Z,G as ee,E as te,C as ae,v as se,V as ie}from"./settings-icon-D7Ehrjnx.js";import{b as re}from"./litigations-CmIaLu41.js";import{D as ne}from"./advocate-CZvQPyEV.js";import{u as oe}from"./userDetails-BKeSBteA.js";import{N as ce}from"./NoDataBlock-B_IMWKz8.js";import{u as P}from"./useUserPermissions-DqHuV15h.js";import{u as le}from"./useQuery-aXFamHAp.js";import{u as me}from"./index-Bz18Tu21.js";import{S as de}from"./SearchFilter-BBJ8x_iV.js";import{D}from"./default-user-B5Qt0uKr.js";import{V as ue}from"./view-icon-Ctx0vsE9.js";import{A as I,a as pe}from"./avatar-I9rQhuEx.js";import{s as A,c as W}from"./statusConstants-CRfW9VUD.js";import{c as z}from"./app-BaxlpBql.js";import{d as ge}from"./dayjs.min-BPVt0UoP.js";import{S as xe}from"./SearchDropdown-BIeLOPsK.js";import{P as he}from"./plus-DadH4F41.js";import"./select-BAZmUwVY.js";import"./index-CXHJR4o1.js";import"./index-DFgmobCw.js";import"./index-NA-xklZo.js";import"./index-BfzcKS58.js";import"./index-BrJXLgSY.js";import"./index-C-zDLRzy.js";import"./index-DGqRz6qL.js";import"./index-CB5qnijn.js";import"./chevron-down-DFI8aQgh.js";import"./createLucideIcon-2fvSvvVa.js";import"./check-CKzaR09m.js";import"./skeleton-CGIrBuj0.js";import"./input-BFw7NH1J.js";import"./chevron-right-63yA6sUh.js";import"./OverflowContentTooltip-CyyzhEvg.js";import"./tooltip-BNtdrHqg.js";import"./index-BYuWQ9Ar.js";import"./calendar-icon-B7MKdTU1.js";import"./litigation-CPq33wDP.js";import"./legal-notice-icon-DY79a5uN.js";import"./pending-icon-xk-CqbVY.js";import"./approved-Icon-sUM8RCgD.js";import"./current-icon-dhgqbcsv.js";import"./x-ClszbkRs.js";import"./summary-icon-card-x7nT6ld4.js";import"./todo-icon-DW7pQKrg.js";import"./card-Byeow1YH.js";import"./fetch-BYBqU-UB.js";import"./no-cases-data-D0ClwAfz.js";import"./noDataConstants-nJx6rPaL.js";import"./search-ElaKESin.js";function fe(){const g=E(),c=L(),{isUser:x,isManager:j,isAdvocate:h,isAdmin:i}=P(),N=e=>{if(sessionStorage.setItem("case-origin","litigation"),x()){c({to:`/litigations/service/${e}/user/manage`});return}c({to:`/litigations/service/${e}/manage`})},f=[{accessorFn:e=>e.temp_id,id:"case_reference",header:()=>t.jsx("span",{className:"text-sm",children:"File ID"}),footer:e=>e.column.id,width:"150px",maxWidth:"150px",minWidth:"150px",cell:e=>t.jsx("span",{className:"text-xs",children:e.getValue()||"--"})},{accessorFn:e=>e.organisation_name,id:"organization_name",cell:e=>t.jsx("div",{className:"text-xs  w-36 truncate",title:e.getValue(),children:e.getValue()||"--"}),width:"180px",maxWidth:"180px",minWidth:"180px",header:()=>t.jsx("span",{className:"text-sm  ",children:"Organization"}),footer:e=>e.column.id},{accessorFn:e=>e.advocate_cases||[],id:"advocates",header:()=>t.jsx("span",{className:"text-sm",children:"Advocates"}),footer:e=>e.column.id,width:"180px",maxWidth:"220px",minWidth:"180px",cell:e=>{const s=e.getValue(),r=`litigation-${e.row.original.id}`;if(!s||s.length===0)return t.jsx("span",{className:"text-xs",children:"Not Assigned"});if(s.length===1){const d=s[0].advocate,l=d?`${d.first_name||""} ${d.last_name||""}`.trim():"Unknown Advocate";return t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(I,{className:"w-7 h-7 flex items-center justify-center rounded-full bg-[#F7F7F7] border-none",children:d?.profile_pic?t.jsx(pe,{src:d.profile_pic,alt:l,className:"rounded-full h-7 w-7 object-cover object-top"}):t.jsx(D,{className:"w-3 h-3"})}),t.jsx("span",{className:"text-xs max-w-32 truncate cursor-pointer",title:l,children:l||"--"})]})}return t.jsx(Q,{advocateCases:s,id:r})}},{accessorFn:e=>e.service?.issue||e.service_type||"",id:"service_type",header:()=>t.jsx("span",{className:"text-sm",children:" Issue"}),footer:e=>e.column.id,width:"120px",maxWidth:"120px",minWidth:"120px",cell:e=>t.jsx("span",{className:"text-xs",children:e.getValue()||"--"})},{accessorFn:e=>e.stage||"",id:"priority",header:()=>t.jsx("span",{className:"text-sm",children:" Stage"}),footer:e=>e.column.id,width:"160px",maxWidth:"160px",minWidth:"160px",cell:e=>e.getValue()?t.jsx("span",{className:"text-xs uppercase font-normal",style:{color:A.find(r=>r.value===e.getValue())?.color},children:A.find(r=>r.value===e.getValue())?.label}):"--"},{accessorFn:e=>e.next_hearing_date||"",id:"next_hearing",header:()=>t.jsx("span",{className:"text-sm",children:"Next Hearing"}),footer:e=>e.column.id,width:"180px",maxWidth:"220px",minWidth:"180px",cell:e=>{const s=e.getValue();return t.jsxs("span",{className:"text-xs",children:[s?ge(s).format("DD MMM YYYY"):"--"," "]})}},{accessorFn:e=>e,id:"actions",header:()=>t.jsx("span",{className:"text-sm",children:"Actions"}),footer:e=>e.column.id,width:"120px",minWidth:"120px",maxWidth:"120px",cell:e=>t.jsxs("div",{className:"table-action-buttons text-xs flex space-x-3 items-center cursor-pointer",children:[t.jsx("span",{onClick:()=>{sessionStorage.setItem("case-origin","litigation"),g.navigate({to:`/litigations/service/${e.row.original.id}/case-history`})},title:"View Service",children:t.jsx(ue,{className:"size-4"})}),t.jsx("span",{onClick:()=>{N(e.row.original.id)},title:"Manage Service",children:t.jsx(J,{className:"size-4 text-black"})})]})}];return(h()||j()||x()||i())&&f.splice(2,0,{accessorFn:e=>{const s=e.user?.first_name?z(e.user.first_name):"",r=e.user?.last_name?z(e.user.last_name):"";return{fullname:`${s} ${r}`,avatar:null}},id:"customer_name",header:()=>t.jsx("span",{className:"text-sm",children:"Point of Contact"}),footer:e=>e.column.id,width:"200px",maxWidth:"200px",minWidth:"200px",cell:e=>{const{fullname:s}=e.getValue()||{fullname:"--"};return t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx(I,{className:"w-7 h-7 flex items-center justify-center rounded-full bg-[#F7F7F7] border border-grey-800 ",children:t.jsx(D,{className:"w-4 h-4"})}),t.jsx("div",{className:"self-center text-xs w-36 truncate",title:s,children:s})]})}}),f}const ve=({heightClass:g=ne})=>{const c=E(),x=L(),j=me(),h=o.useRef(!0),i=new URLSearchParams(j.search),[N,f]=o.useState(!1),[e,s]=o.useState(X()),[r,d]=o.useState(i.get("search_string")||""),[l,T]=o.useState(i.get("search_string")||""),[p,_]=o.useState(i.get("status")||""),O=W.find(a=>a.value===p)?.label||"",[y,b]=o.useState(O),[u,v]=o.useState({current_page:Number(i.get("page"))||1,page_size:Number(i.get("page_size"))||15}),{isAdvocate:$,isAdmin:C,isUser:F}=P(),k=q(oe,a=>a.user),G=fe(),{isLoading:w,data:m,refetch:je}=le({queryKey:["getLitigation",u,k?.id,l,e,p],queryFn:async()=>{const a={page:Number(u.current_page),page_size:Number(u.page_size),...l&&{search_string:l},...p&&{status:p},view:e};c.navigate({to:"/litigations",search:a});const n=await re(a);if(n?.status===200||n?.status===201)return n.data?.data},enabled:!!u.current_page,refetchOnWindowFocus:!1}),M=!w&&m?.pagination_info&&m?.records&&m?.records?.length>0,U=async({page:a,page_size:n})=>{v({current_page:a,page_size:n}),c.navigate({to:"/litigations",search:{...Object.fromEntries(i),page:a,page_size:n,view:e}})},H=a=>{v(n=>({...n,current_page:a})),c.navigate({to:"/litigations",search:{...Object.fromEntries(i),page:a,view:e}})},R=a=>{v(n=>({...n,page_size:a,current_page:1})),c.navigate({to:"/litigations",search:{...Object.fromEntries(i),page_size:a,page:1,view:e}})},V=a=>{s(a),se.setViewState(ie.LITIGATION,a),c.navigate({to:"/litigations",search:{...Object.fromEntries(i),view:a,page:u.current_page,page_size:u.page_size}})};o.useEffect(()=>{const a=setTimeout(()=>{T(r),h.current?h.current=!1:(v(n=>({...n,current_page:1})),c.navigate({to:"/litigations",search:{...Object.fromEntries(i),search_string:r,page:1,page_size:u.page_size}}))},1e3);return()=>clearTimeout(a)},[r]),o.useEffect(()=>{f(!0)},[]);const Y=W.filter(a=>a.label.includes(y));return t.jsx("div",{className:"overflow-hidden h-full relative",children:N&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex justify-between items-center gap-x-8 mb-2",children:[t.jsxs("div",{className:"flex items-center border border-gray-200",children:[t.jsx(S,{variant:e==="table"?"default":"outline",size:"sm",onClick:()=>V("table"),className:`h-8 px-3 !rounded-none  cursor-pointer ${e==="table"?"bg-gray-200 text-white":"bg-white-300 text-white hover:bg-gray-50 "}`,children:t.jsx(Z,{className:"w-5 h-5"})}),t.jsx(S,{variant:e==="grid"?"default":"outline",size:"sm",onClick:()=>V("grid"),className:`h-8 !rounded-none px-3 cursor-pointer ${e==="grid"?"bg-gray-200 text-white":"bg-white-300 text-white hover:bg-gray-50 "}`,children:t.jsx(ee,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex gap-x-3",children:[!F()&&t.jsx(de,{searchString:r,setSearchString:d,title:"Search by Point of Contact"}),(C()||F())&&t.jsx(xe,{options:Y,value:p,onSelect:a=>{_(a.value),b(a.label)},onClear:()=>{_(""),b("")},placeholder:"Filter by Status",getOptionLabel:a=>a.label,getOptionKey:a=>a.value,isSelected:a=>a.value===p,width:"w-44",className:"h-9",searchValue:y,onSearchChange:b}),!$()&&!C()&&t.jsx(S,{className:"bg-black !text-white hover:bg-gray-800 cursor-pointer group focus:ring-none active:scale-95 !rounded-none h-9 px-6 py-0 transition duration-300 text-sm  3xl:text-base font-normal",onClick:()=>x({to:"/create-litigation"}),children:t.jsxs("div",{className:"flex flex-row space-x-1 justify-center items-center  ",children:[t.jsx(he,{className:"font-extralight w-6 h-6 group-hover:rotate-90 duration-300"}),t.jsx("div",{className:"font-extralight",children:" New Service"})]})})]})]}),e==="table"?t.jsx("div",{className:"",children:t.jsx(K,{data:m?.records||[],columns:G,paginationDetails:m?.pagination_info,getData:U,loading:w,removeSortingForColumnIds:["case_reference","service_type","customer_name","advocate_name","priority","organization_name","next_hearing","advocates","actions"],heightClass:g,noDataLabel:"litigations",noDataDescription:"Get started by creating your first litigations",showNoDataIcon:!0,noDataHeight:g||"h-[calc(100vh-170px)]"})}):t.jsxs("div",{className:"flex flex-col h-[calc(100vh-115px)]",children:[t.jsx("div",{className:"flex-1 overflow-y-auto",children:w?t.jsx(te,{}):m?.records&&m?.records?.length>0?t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xll:grid-cols-4  2xl:gap-4",children:m?.records?.map(a=>t.jsx(ae,{record:a},a.id))}):t.jsx("div",{className:"flex justify-center items-center w-full h-120",children:t.jsx(ce,{title:"litigations",description:l?"Try adjusting your search criteria":"Get started by creating your first litigation",hasSearch:!!l,height:"h-full"})})}),M&&t.jsx("div",{className:"flex justify-center items-center gap-4 border-gray-200",children:t.jsx(B,{paginationDetails:m?.pagination_info,capturePageNum:H,captureRowPerItems:R})})]})]})})},ft=ve;export{ft as component};
