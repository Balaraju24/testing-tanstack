import{h as y,r as n,j as e,B as d}from"./main-CbopZ6M6.js";import{U as w}from"./Provider-BC_HjP_o.js";import{I as S}from"./input-BFw7NH1J.js";import{q as _}from"./manage-UYlebOZ2.js";import{i as E,M as R}from"./ManageCaseHeader-5m-OMl3k.js";import{u as k}from"./useMutation-AZp6LET6.js";import{G as A}from"./GetCaseNotes-BQlQ731L.js";import{L as D}from"./loader-circle-CHBElFpm.js";import"./litigations-CmIaLu41.js";import"./fetch-BYBqU-UB.js";import"./useQuery-aXFamHAp.js";import"./useInfiniteQuery-DCpiOsiQ.js";import"./index-Bz18Tu21.js";import"./index-DFgmobCw.js";import"./index-9N-Gpv7K.js";import"./Loading-DliovM0z.js";import"./CaseFilingIcon-Ki22rwHg.js";import"./legal-notice-icon-DY79a5uN.js";import"./notes-edit-icon-Dx1vAmyL.js";import"./index-CXHJR4o1.js";import"./index-BfzcKS58.js";import"./index-BYuWQ9Ar.js";import"./tooltip-BNtdrHqg.js";import"./index-NA-xklZo.js";import"./index-C-zDLRzy.js";import"./index-CB5qnijn.js";import"./manage-Dtja-RKh.js";import"./dayjs.min-BPVt0UoP.js";import"./utc-YeGeLL22.js";import"./useUserPermissions-DqHuV15h.js";import"./userDetails-BKeSBteA.js";import"./pending-icon-xk-CqbVY.js";import"./approved-Icon-sUM8RCgD.js";import"./current-icon-dhgqbcsv.js";import"./chevron-down-DFI8aQgh.js";import"./createLucideIcon-2fvSvvVa.js";import"./complete-logo-BdyjTQM1.js";import"./notes-close-icon-CZlPG_WL.js";import"./index-Bn1KO0DZ.js";import"./index-BrJXLgSY.js";import"./textarea-DVdyI6Fw.js";import"./notification-B2GbDUfo.js";import"./service-Clbc7XwB.js";import"./fileUpload-CyZu8moV.js";import"./index-BFdYt5ff.js";import"./x-ClszbkRs.js";import"./default-user-B5Qt0uKr.js";import"./notes-delete-icon-COtxmY5M.js";import"./notes-head-icon-zA5gOWGa.js";import"./summary-icon-card-x7nT6ld4.js";import"./avatar-I9rQhuEx.js";import"./sheet-KGfwaNTI.js";import"./skeleton-CGIrBuj0.js";const De=({stage:x,subStage:m})=>{const{service_id:h}=y({strict:!1}),[f,i]=n.useState(""),[l,c]=n.useState(!1),[o,p]=n.useState(""),{caseStagesData:N,serviceData:s,setServiceData:g}=w(),u=E(N?.sub_stages,m),{mutate:j,isPending:a}=k({mutationFn:async t=>await _(h,t),onSuccess:()=>{g(t=>({...t,cnr_number:o})),c(!1)},onError:t=>{if(t?.status===404||t?.status===401)i(t.message);else if(t.status==422){let r=t.data.errData;i(r?.cnr_number[0])}else if(t.status==409){let r=t.message;i(r)}}}),b=()=>{if(!o?.trim()){i("CNR Number is required");return}j({cnr_number:o,stage:x,sub_stage:m})},C=()=>{p(s?.cnr_number??""),c(!1),i("")},v=t=>{t.key==="Enter"&&o.length>0&&b()};return n.useEffect(()=>{s&&typeof s.cnr_number=="string"&&p(s.cnr_number)},[s]),e.jsx("div",{className:"h-full",children:e.jsx("div",{className:"h-full px-1",children:e.jsxs("div",{className:"h-full",children:[e.jsx(R,{showActionButton:!l&&!!s?.cnr_number,caseStage:x,caseSubStage:m,showUploadButton:!1}),e.jsxs("div",{className:"p-2 relative w-full  h-[calc(100%-60px)] overflow-auto",children:[e.jsx("div",{className:"py-2 px-2 flex  gap-4 w-full",children:e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-800",children:["CNR Number ",e.jsx("span",{className:"text-sm text-red-600 -mt-0",children:"*"})]}),!l&&s?.cnr_number?e.jsxs("div",{className:"flex bg-slate-100 justify-between items-center text-gray-600 text-sm gap-2 border-none p-2",children:[e.jsx("p",{children:s?.cnr_number}),!u&&e.jsx(d,{className:"bg-transparent h-fit py-0 cursor-pointer font-semibold underline text-xs",onClick:()=>c(!0),children:"Edit"})]}):e.jsxs("div",{className:"space-y-2 w-full mt-1",children:[e.jsx(S,{placeholder:"Enter CNR Number",value:o,onChange:t=>{const r=t.target.value.toUpperCase().trim();/^[A-Z0-9]*$/.test(r)&&(p(r),i(""))},onKeyDown:v,maxLength:16,disabled:a||u,className:"w-full rounded-none border  border-gray-300 h-fit  focus:outline-none focus-visible:outline-none bg-gray-100 text-black"}),f&&e.jsx("span",{className:"text-red-500 text-xs block mt-1",children:f}),e.jsxs("div",{className:"flex justify-end gap-2",children:[l&&e.jsx(d,{onClick:C,disabled:a,variant:"outline",className:"rounded-none text-red-500 text-xs  cursor-pointer h-8 py-1.5 font-normal",children:"Cancel"}),e.jsx(d,{onClick:b,disabled:a||u,className:"rounded-none text-white text-xs cursor-pointer bg-black h-8 py-1.5 font-normal hover:bg-black",children:a?e.jsxs("div",{className:"flex",children:["Submitting...",e.jsx(D,{className:"animate-spin mx-1"})]}):"Submit"})]})]})]})}),e.jsx(A,{})]})]})})})};export{De as default};
