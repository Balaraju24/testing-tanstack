import{h as f,t as i,j as e,B as h}from"./main-CbopZ6M6.js";import{L as v}from"./Loading-DliovM0z.js";import{D as w}from"./disposal-call-logo-BSghrICU.js";import{S as j}from"./submit-case-icon-B5IXmAD9.js";import{s as y,g,n as N}from"./manage-UYlebOZ2.js";import{u as n}from"./useQuery-aXFamHAp.js";import{u as b}from"./useMutation-AZp6LET6.js";import{M as S}from"./ManageCaseHeader-5m-OMl3k.js";import{F as k}from"./FeedbackCard-CFRW3ZTH.js";import"./fetch-BYBqU-UB.js";import"./index-9N-Gpv7K.js";import"./Provider-BC_HjP_o.js";import"./litigations-CmIaLu41.js";import"./useInfiniteQuery-DCpiOsiQ.js";import"./index-Bz18Tu21.js";import"./index-DFgmobCw.js";import"./CaseFilingIcon-Ki22rwHg.js";import"./legal-notice-icon-DY79a5uN.js";import"./notes-edit-icon-Dx1vAmyL.js";import"./index-CXHJR4o1.js";import"./index-BfzcKS58.js";import"./index-BYuWQ9Ar.js";import"./tooltip-BNtdrHqg.js";import"./index-NA-xklZo.js";import"./index-C-zDLRzy.js";import"./index-CB5qnijn.js";import"./manage-Dtja-RKh.js";import"./dayjs.min-BPVt0UoP.js";import"./utc-YeGeLL22.js";import"./useUserPermissions-DqHuV15h.js";import"./userDetails-BKeSBteA.js";import"./pending-icon-xk-CqbVY.js";import"./approved-Icon-sUM8RCgD.js";import"./current-icon-dhgqbcsv.js";import"./chevron-down-DFI8aQgh.js";import"./createLucideIcon-2fvSvvVa.js";import"./complete-logo-BdyjTQM1.js";import"./notes-close-icon-CZlPG_WL.js";import"./index-Bn1KO0DZ.js";import"./index-BrJXLgSY.js";import"./textarea-DVdyI6Fw.js";import"./loader-circle-CHBElFpm.js";import"./notification-B2GbDUfo.js";import"./service-Clbc7XwB.js";import"./fileUpload-CyZu8moV.js";import"./index-BFdYt5ff.js";import"./x-ClszbkRs.js";import"./default-user-B5Qt0uKr.js";import"./notes-delete-icon-COtxmY5M.js";import"./notes-head-icon-zA5gOWGa.js";import"./summary-icon-card-x7nT6ld4.js";import"./avatar-I9rQhuEx.js";import"./input-BFw7NH1J.js";import"./sheet-KGfwaNTI.js";import"./skeleton-CGIrBuj0.js";import"./nyaya-tech-logo-mskrgLnn.js";import"./UnOrderList-Nbg-fKcI.js";const Le=({stage:m,subStage:l})=>{const{service_id:s}=f({strict:!1}),{isFetching:o,data:a}=n({queryKey:["review-details",s],enabled:!!s,queryFn:async()=>{try{if(!s)return;const t=await g(Number(s));if(t.status===200||t.status===201)return t?.data?.data}catch{throw new Error("Failed to fetch Data")}},refetchOnWindowFocus:!1}),{data:c,refetch:p}=n({queryKey:["case-review-status",s],enabled:!!s,refetchOnWindowFocus:!1,queryFn:async()=>{try{if(!s)return;const t=await N(s);if(t.status===200||t.status===201){const{data:r}=t?.data;return r}}catch{throw new Error("Failed to fetch case data")}}}),{mutate:d,isPending:u}=b({mutationFn:async()=>{const t={caseId:Number(s)};return(await y(s,t))?.data},onSuccess:t=>{p(),i.success(t?.message,{action:{label:"✕",onClick:()=>i.dismiss()}})},onError:()=>{i.error("Failed to send Review link",{action:{label:"✕",onClick:()=>i.dismiss()}})}}),x=a?.filter(t=>t?.feedback_type==="NYAYA_TECH");return e.jsx("div",{className:"h-full",children:e.jsxs("div",{className:"h-full",children:[e.jsx(S,{showNoteButton:!1,showActionButton:a?.length!==0,showSummaryButton:!1,showUploadButton:!1,caseStage:m,caseSubStage:l}),e.jsx("div",{className:"h-[calc(100%-55px)] overflow-auto relative  p-2",children:a?.length===0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 justify-center",children:[e.jsx("div",{className:"my-4",children:e.jsx(w,{})}),e.jsx("div",{className:"font-medium text-xl",children:"Case Status Update"}),e.jsx("div",{className:"w-2/3 text-center my-2",children:"This case is in the final stage and waiting for the user’s review to complete ."})]}),c?.is_review_link_sent&&e.jsxs("div",{className:"flex flex-col items-center gap-4 justify-center",children:[e.jsx("div",{className:"mt-10 my-6",children:e.jsx(j,{})}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("div",{className:"text-xl 3xl:text-2xl text-green-600",children:"Review Link Sent"}),e.jsx("div",{className:"3xl:text-base",children:"We are waiting for the user to submit their review"})]}),e.jsx(h,{className:"underline 3xl:text-base cursor-pointer bg-transparent",onClick:()=>{d()},disabled:u,children:"Resend Link"})]})]}):o?e.jsx(v,{loading:o}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"h-full overflow-auto space-y-4 flex flex-col",children:e.jsx("div",{className:"flex-1 min-h-0 flex flex-col ",children:e.jsx("div",{className:" overflow-auto shrink-0",children:x?.map(t=>e.jsx(k,{review:t},t.id))})})})})})]})})};export{Le as default};
